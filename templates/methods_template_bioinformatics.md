# Methods Section Template for Bioinformatics Pipeline/Tool Papers

## Standard Structure for Pipeline Papers (BMC Bioinformatics)

### Overview Subsection
- Brief description (2-3 sentences) of what the tool does
- Programming language and implementation approach
- Key design principles or novel features

### Input Data Subsection (if applicable)
- Required input formats
- Any preprocessing steps
- Example: "The pipeline accepts viral genomes in FASTA format and reference annotations in GenBank format."

### Algorithm/Workflow Subsection(s)
For each major module or step:
- Purpose and approach
- Key algorithms with citations
- Parameter choices and justification
- Quality control steps
- Example outputs

**Template for each module:**
```
### [Module Name]

[Module purpose - 1 sentence]

[Detailed description of approach - 2-3 paragraphs covering]:
- Input processing
- Core algorithm with citations to methods used
- Parameter settings and thresholds with justification
- Quality control or validation steps
- Output format and content

[Software dependencies with versions and citations]
```

### Implementation and Availability Subsection
**Required information for BMC Bioinformatics:**
- Programming language(s)
- Key dependencies with versions
- Installation method (conda, pip, docker, etc.)
- Source code location (GitHub URL)
- License
- Documentation location
- Example/test datasets

**Standard text template:**
```
[TOOL_NAME] is implemented in [LANGUAGE] and available at [GITHUB_URL] under [LICENSE] license. 
The pipeline requires [DEPENDENCY1] [VERSION] [REF], [DEPENDENCY2] [VERSION] [REF], and [DEPENDENCY3] [VERSION] [REF]. 
Installation is managed through [conda/pip/docker] with environment files provided for reproducibility. 
Documentation includes step-by-step tutorials and test datasets for [USE CASES].
```

---

## Example: VICAST Methods Section

### VICAST: Viral Cultured-virus Annotation and SnpEff Toolkit

#### Overview
VICAST is a modular Python-based pipeline for annotating viral genomes and analyzing sequence variants [REF:github_vicast]. The pipeline consists of two independent modules: (1) genome annotation transfer and (2) variant calling and functional annotation. Both modules utilize conda environments for dependency management and are designed to handle diverse viral families.

#### Module 1: Genome Annotation Transfer

The annotation module transfers protein annotations from a reference viral genome to query genomes using BLAST-based homology detection [REF:blast]. Users provide a reference genome in GenBank format, query genome in FASTA format, and a configuration file specifying protein features to transfer.

The pipeline performs six-frame translation of the query genome using Biopython [REF:biopython] and identifies homologous proteins via BLASTp [REF:blast] against the reference proteome. Annotation transfer employs a hierarchical matching strategy: (1) reciprocal best BLAST hits with ≥80% coverage and ≥30% identity, (2) unidirectional best hits meeting the same thresholds, and (3) lower-stringency matches for challenging cases. For polyproteins, the pipeline identifies mature peptide boundaries based on reference genome coordinates and transfers both polyprotein and cleavage product annotations.

Quality control includes comparing expected versus recovered protein counts, flagging potential frameshifts, and validating genomic coordinates against reference structure. Outputs include annotated GenBank files, protein FASTA files, and detailed transfer reports with per-protein statistics.

#### Module 2: Variant Analysis with SnpEff Integration

The variant analysis module creates custom SnpEff databases [REF:snpeff] from annotated genomes and predicts functional effects of sequence variants. The pipeline converts GenBank annotations to GFF3 format using custom parsers, builds genome-specific SnpEff databases, and integrates with standard variant calling workflows.

Users provide BAM alignment files generated by BWA [REF:bwa] or similar aligners and the annotated reference genome from Module 1. Variants are called using lofreq [REF:lofreq] with minimum depth of 10× and quality score ≥20. SnpEff annotates variants with predicted effects including synonymous and non-synonymous changes, frameshift mutations, and impacts on start/stop codons.

Outputs include VCF files with functional annotations, variant summary statistics, and visualizations of variant distributions across genomic features using matplotlib [REF:matplotlib].

#### Implementation and Availability

VICAST is implemented in Python 3.8+ with Bash wrapper scripts and is available at https://github.com/mihinduk/VICAST under MIT license. The pipeline requires BLAST+ 2.12+ [REF:blast], lofreq 2.1.5 [REF:lofreq], SnpEff 5.1 [REF:snpeff], samtools 1.15 [REF:samtools], BWA 0.7.17 [REF:bwa], and Biopython 1.79 [REF:biopython]. Conda environment files ensure reproducible installation across platforms. Comprehensive documentation includes tutorials, parameter descriptions, and test datasets for Flaviviridae and Coronaviridae families.

---

## Citation Templates for Common Bioinformatics Software

### Sequence Analysis Tools

**BLAST:**
```
Altschul SF, Gish W, Miller W, Myers EW, Lipman DJ. Basic local alignment search tool. 
J Mol Biol. 1990;215(3):403-410. https://doi.org/10.1016/S0022-2836(05)80360-2
```

**BWA:**
```
Li H, Durbin R. Fast and accurate short read alignment with Burrows-Wheeler transform. 
Bioinformatics. 2009;25(14):1754-1760. https://doi.org/10.1093/bioinformatics/btp324
```

**samtools:**
```
Li H, Handsaker B, Wysoker A, Fennell T, Ruan J, Homer N, et al. The Sequence Alignment/Map 
format and SAMtools. Bioinformatics. 2009;25(16):2078-2079. 
https://doi.org/10.1093/bioinformatics/btp352
```

### Variant Calling

**lofreq:**
```
Wilm A, Aw PPK, Bertrand D, Yeo GHT, Ong SH, Wong CH, et al. LoFreq: a sequence-quality 
aware, ultra-sensitive variant caller for uncovering cell-population heterogeneity from 
high-throughput sequencing datasets. Nucleic Acids Res. 2012;40(22):11189-11201. 
https://doi.org/10.1093/nar/gks918
```

**SnpEff:**
```
Cingolani P, Platts A, Wang LL, Coon M, Nguyen T, Wang L, et al. A program for annotating 
and predicting the effects of single nucleotide polymorphisms, SnpEff: SNPs in the genome 
of Drosophila melanogaster strain w1118; iso-2; iso-3. Fly. 2012;6(2):80-92. 
https://doi.org/10.4161/fly.19695
```

### Python Libraries

**Biopython:**
```
Cock PJA, Antao T, Chang JT, Chapman BA, Cox CJ, Dalke A, et al. Biopython: freely 
available Python tools for computational molecular biology and bioinformatics. 
Bioinformatics. 2009;25(11):1422-1423. https://doi.org/10.1093/bioinformatics/btp163
```

**NumPy:**
```
Harris CR, Millman KJ, van der Walt SJ, Gommers R, Virtanen P, Cournapeau D, et al. 
Array programming with NumPy. Nature. 2020;585(7825):357-362. 
https://doi.org/10.1038/s41586-020-2649-2
```

**pandas:**
```
McKinney W. Data Structures for Statistical Computing in Python. Proceedings of the 
9th Python in Science Conference. 2010:56-61. https://doi.org/10.25080/Majora-92bf1922-00a
```

**matplotlib:**
```
Hunter JD. Matplotlib: A 2D graphics environment. Comput Sci Eng. 2007;9(3):90-95. 
https://doi.org/10.1109/MCSE.2007.55
```

---

## Parameter Reporting Best Practices

When describing parameters:
1. **Report all non-default parameters explicitly**
2. **Justify threshold choices** (cite similar studies or pilot analyses)
3. **Be specific about versions** (software behavior changes)
4. **Document custom scripts/modifications**

**Good example:**
"BLASTp searches used an e-value threshold of 1e-5, minimum alignment coverage of 80%, and minimum identity of 30%. These thresholds were chosen to balance sensitivity for divergent viral sequences while maintaining specificity, consistent with previous viral genome annotation studies [REF]."

**Poor example:**
"BLAST was used with standard parameters."

---

## Quality Control Reporting

Always describe QC steps:
- What metrics were checked?
- What thresholds were used?
- How were failures handled?
- What percentage passed QC?

**Example:**
"Quality control flagged samples with <10× average coverage (5/150 samples), evidence of mixed infections based on variant allele frequencies >0.3 (12/150), or >100 ambiguous bases in consensus sequences (3/150). Flagged samples were excluded from downstream analysis."

---

## Software Citation Checklist

For each software tool, include:
- [ ] Software name
- [ ] Version number
- [ ] Citation to primary publication
- [ ] URL if no publication (with access date)
- [ ] Key parameters if non-default
- [ ] Any modifications made

---

## Common Mistakes to Avoid

1. ❌ **Vague software versions**: "BLAST" → ✅ "BLAST+ 2.12.0"
2. ❌ **Missing parameter details**: "default settings" → ✅ Specific values
3. ❌ **No justification for thresholds**: "80% identity" → ✅ "80% identity, chosen based on pilot testing with divergent strains [REF]"
4. ❌ **Incomplete citations**: "SnpEff was used" → ✅ "SnpEff 5.1 [REF:cingolani2012]"
5. ❌ **No QC description**: "Data were filtered" → ✅ Specific QC metrics and thresholds
6. ❌ **Missing availability info**: No GitHub link → ✅ Full availability statement

---

## Usage with This Skill

1. Write methods using [REF:key] placeholders
2. Maintain references.bib with all citations
3. Use compile_manuscript.py to generate formatted document
4. Citations automatically numbered and formatted for journal style
